# üß≠ –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∑–∞–¥–∞—á–∞—Ç–∞  
### MetroSim: –°–∏–º—É–ª–∞—Ç–æ—Ä –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞ –º—Ä–µ–∂–∞ —Å –ø–∞—Ä–∞–ª–µ–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ (Swing, Java 17)

---

## üéØ –û–±—â –ø—Ä–µ–≥–ª–µ–¥

**MetroSim** –µ –¥–µ—Å–∫—Ç–æ–ø —Å–∏–º—É–ª–∞—Ç–æ—Ä –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞ –º—Ä–µ–∂–∞, –∫–æ–π—Ç–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–∞ –¥–≤–∏–∂–µ–Ω–∏–µ—Ç–æ –Ω–∞ –ø—Ä–µ–≤–æ–∑–Ω–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ –æ–ø—Ä–æ—Å—Ç–µ–Ω–∞ –º–µ—Ç—Ä–æ/–∞–≤—Ç–æ–±—É—Å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞.  
–ü—Ä–æ–µ–∫—Ç—ä—Ç –ø–æ–∫–∞–∑–≤–∞ –∫–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–æ **—à–∞–±–ª–æ–Ω–∏ –∑–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω–µ (Design Patterns)** –º–æ–≥–∞—Ç –¥–∞ –±—ä–¥–∞—Ç –∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∏ –≤ **–ø–∞—Ä–∞–ª–µ–ª–Ω–æ, —Å—ä–±–∏—Ç–∏–π–Ω–æ –∏ —Ä–∞–∑—à–∏—Ä—è–µ–º–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**, –∏–∑–≥—Ä–∞–¥–µ–Ω–æ —Å—ä—Å **Java Swing**.

–¶–µ–ª—Ç–∞ –µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –¥–∞ —Å–ª—É–∂–∏ –∫–∞—Ç–æ **–ø—Ä–∏–º–µ—Ä–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è** –∑–∞ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–∏ –∫—É—Ä—Å–æ–≤–µ –ø–æ:

- **–®–∞–±–ª–æ–Ω–∏ –∑–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω–µ (Design Patterns)** ‚Äì –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–∞–π–∫–∏ –∫–∞–∫ —Ä–∞–∑–ª–∏—á–Ω–∏ —à–∞–±–ª–æ–Ω–∏ —Å–µ –∫–æ–º–±–∏–Ω–∏—Ä–∞—Ç –≤ –æ–±—â–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.  
- **–ü–∞—Ä–∞–ª–µ–ª–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ** ‚Äì –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å –Ω–∏—à–∫–∏ –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç –≤ –≥—Ä–∞—Ñ–∏—á–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.  

> üß© –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –∏–∑–ø–æ–ª–∑–≤–∞ **Java Swing** –∑–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ **Executor-–±–∞–∑–∏—Ä–∞–Ω–∞ –ø–∞—Ä–∞–ª–µ–ª–∏–∑–∞—Ü–∏—è** –∑–∞ —Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–Ω–æ—Ç–æ —è–¥—Ä–æ.

---

## üß† –ó–∞–¥–∞—á–∞

–î–∞ —Å–µ —Ä–µ–∞–ª–∏–∑–∏—Ä–∞ —Å–∏–º—É–ª–∞—Ç–æ—Ä –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞ –º—Ä–µ–∂–∞ (–º–µ—Ç—Ä–æ), –≤ –∫–æ–π—Ç–æ –Ω—è–∫–æ–ª–∫–æ –ø—Ä–µ–≤–æ–∑–Ω–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–µ –¥–≤–∏–∂–∞—Ç –ø–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –∑–∞–¥–∞–¥–µ–Ω–∏ –º–∞—Ä—à—Ä—É—Ç–∏.  

–í—Å—è–∫–æ –ø—Ä–µ–≤–æ–∑–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤–æ:
- —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –æ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤—ä–∑–µ–ª (–ø–æ–∑–∏—Ü–∏—è);
- —Å–µ –ø—Ä–∏–¥–≤–∏–∂–≤–∞ —Å—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞ –∫—ä–º –∫—Ä–∞–π–Ω–∞—Ç–∞ —Å–∏ —Ç–æ—á–∫–∞;
- –ø—Ä–∏ –¥–æ—Å—Ç–∏–≥–∞–Ω–µ —Å–ø–∏—Ä–∞ –∑–∞ –∫—Ä–∞—Ç—ä–∫ –ø—Ä–µ—Å—Ç–æ–π (‚Äûdwell‚Äú), —Å–ª–µ–¥ –∫–æ–µ—Ç–æ –æ–±—Ä—ä—â–∞ –ø–æ—Å–æ–∫–∞—Ç–∞;
- —Å–µ –¥–≤–∏–∂–∏ **–µ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** —Å –æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ –ø—Ä–µ–≤–æ–∑–Ω–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞.

–°–∏—Å—Ç–µ–º–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞:
- –ø–æ–¥–¥—ä—Ä–∂–∞ –≤—ä—Ç—Ä–µ—à–µ–Ω **—Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–µ–Ω —á–∞—Å–æ–≤–Ω–∏–∫**;
- –ø–æ–∑–≤–æ–ª—è–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á—Ä–µ–∑ –±—É—Ç–æ–Ω–∏ **Start / Pause**;
- –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞ –≥—Ä–∞—Ñ–∏—á–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ –±–µ–∑ –¥–∞ –±–ª–æ–∫–∏—Ä–∞ Event Dispatch Thread (EDT);
- –±—ä–¥–µ **–ª–µ—Å–Ω–æ —Ä–∞–∑—à–∏—Ä—è–µ–º–∞** –∑–∞ –Ω–æ–≤–∏ —Ç–µ–º–∏, –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –∑–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–∞–Ω–µ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏.

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞

| –°–ª–æ–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----------|
| [**app/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/app) | –ì–ª–∞–≤–Ω–∞ —Ç–æ—á–∫–∞ –Ω–∞ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ([`Bootstrap.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/app/Bootstrap.java), [`MetroSimApp.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/app/MetroSimApp.java)). |
| [**ui/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/ui) | –ì—Ä–∞—Ñ–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Swing) ‚Äì [`MainWindow.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/ui/MainWindow.java), –ø–∞–Ω–µ–ª–∏ –∏ –º–µ–¥–∏–∞—Ç–æ—Ä. |
| [**domain/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/domain) | –û—Å–Ω–æ–≤–Ω–∞ —Å–∏–º—É–ª–∞—Ü–∏–æ–Ω–Ω–∞ –ª–æ–≥–∏–∫–∞ (—Å–≤—è—Ç, –ø—Ä–µ–≤–æ–∑–Ω–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞, —Å—ä—Å—Ç–æ—è–Ω–∏—è, —Å–Ω–∏–º–∫–∏). |
| [**infrastructure/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/infrastructure) | –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–µ–Ω –¥–≤–∏–≥–∞—Ç–µ–ª ([`SimulationEngine.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationEngine.java)) –∏ —Ñ–∞—Å–∞–¥–∞ ([`SimulationFacade.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationFacade.java)). |
| [**services/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/services) | –ê–ª–≥–æ—Ä–∏—Ç–º–∏ –∑–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–∞–Ω–µ, –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –ø–ª—ä–≥–∏–Ω–∏. |
| [**metrics/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/metrics) | –õ–µ–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞ –∏–∑–º–µ—Ä–≤–∞–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–∏–∑–ø–æ–ª–∑–≤–∞–Ω–∞ –æ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∏). |
| [**themes/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/themes) | –¢–µ–º–∏ –∏ —Ü–≤–µ—Ç–æ–≤–∏ –ø–∞–∫–µ—Ç–∏ (Default, Sofia) —á—Ä–µ–∑ –ø–ª—ä–≥–∏–Ω–∏. |
| [**events/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/events) | –°—ä–±–∏—Ç–∏–π–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ (Observer) –∑–∞ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. |

---

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----------|
| **–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** | –ì–ª–∞–≤–µ–Ω –ø—Ä–æ–∑–æ—Ä–µ—Ü —Å –±—É—Ç–æ–Ω–∏ **Start / Pause**, –∫–∞—Ä—Ç–∞, –ø–∞–Ω–µ–ª –∑–∞ –∏–Ω—Å–ø–µ–∫—Ü–∏—è –∏ –≤—Ä–µ–º–µ–≤–∞ –ª–∏–Ω–∏—è. |
| **–°–∏–º—É–ª–∞—Ü–∏–æ–Ω–Ω–æ —è–¥—Ä–æ** | –ü–∞—Ä–∞–ª–µ–ª–µ–Ω –¥–≤–∏–≥–∞—Ç–µ–ª, –∫–æ–π—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞ [`WorldSnapshot`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/domain/WorldSnapshot.java) –∏ –≥–æ –ø—É–±–ª–∏–∫—É–≤–∞ –∫—ä–º UI-—Ç–æ. |
| **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç** | –ü–∞—Ä–∞–ª–µ–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –ø—Ä–µ–≤–æ–∑–Ω–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ —á—Ä–µ–∑ `ForkJoinPool`; –∫–æ–Ω—Ç—Ä–æ–ª –Ω–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ —á—Ä–µ–∑ `CancellationToken`. |
| **–†–∞–∑—à–∏—Ä—è–µ–º–æ—Å—Ç** | –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –≥—Ä–∞–¥—Å–∫–∏ –ø–∞–∫–µ—Ç–∏ —á—Ä–µ–∑ [Java ServiceLoader](https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html). |
| **–ú–µ—Ç—Ä–∏–∫–∏** | –ò–∑–º–µ—Ä–≤–∞–Ω–µ –Ω–∞ –≤—Ä–µ–º–µ –∏ –±—Ä–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ä–µ–∑ [`SimpleMetricsRegistry`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/metrics/SimpleMetricsRegistry.java). |

---

## üß© –ò–∑–ø–æ–ª–∑–≤–∞–Ω–∏ —à–∞–±–ª–æ–Ω–∏ –∑–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–∞–Ω–µ (Design Patterns)

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –®–∞–±–ª–æ–Ω | –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è |
|------------|---------|----------------|
| **–°—ä–∑–¥–∞–≤–∞—â–∏ (Creational)** | [**Abstract Factory**](https://en.wikipedia.org/wiki/Abstract_factory_pattern) | [`CityPackFactory`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/themes/CityPackFactory.java) ‚Äì —Ñ–∞–±—Ä–∏–∫–∞ –∑–∞ —Ç–µ–º–∏ –∏ —Ü–≤–µ—Ç–æ–≤–∏ –ø–∞–ª–∏—Ç—Ä–∏. |
|  | [**Builder**](https://en.wikipedia.org/wiki/Builder_pattern) | [`ScenarioBuilder`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/scenario/ScenarioBuilder.java) ‚Äì –∏–∑–≥—Ä–∞–∂–¥–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–≤–µ—Ç–∞. |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏ (Structural)** | [**Facade**](https://en.wikipedia.org/wiki/Facade_pattern) | [`SimulationFacade`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationFacade.java) ‚Äì —Å–∫—Ä–∏–≤–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –Ω–∏—à–∫–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è. |
|  | [**Decorator**](https://en.wikipedia.org/wiki/Decorator_pattern) | [`MeteredRouter`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/MeteredRouter.java), [`LoggingRouter`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/LoggingRouter.java). |
|  | [**Adapter**](https://en.wikipedia.org/wiki/Adapter_pattern) | [`ThirdPartyRouterAdapter`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/ThirdPartyRouterAdapter.java) ‚Äì –∞–¥–∞–ø—Ç–∏—Ä–∞ –≤—ä–Ω—à–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞ –Ω–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ –ø—ä—Ç–∏—â–∞. |
| **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏ (Behavioral)** | [**Observer**](https://en.wikipedia.org/wiki/Observer_pattern) | [`Subject`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/events/Subject.java) ‚Äì –ø—É–±–ª–∏–∫—É–≤–∞ —Å–Ω–∏–º–∫–∏ –Ω–∞ —Å–≤–µ—Ç–∞ –∫—ä–º –ø–∞–Ω–µ–ª–∏—Ç–µ. |
|  | [**State**](https://en.wikipedia.org/wiki/State_pattern) | [`Vehicle`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/domain/Vehicle.java) ‚Äì –ø—Ä–µ–º–∏–Ω–∞–≤–∞ –ø—Ä–µ–∑ Idle ‚Üí EnRoute ‚Üí Dwell. |
|  | [**Strategy**](https://en.wikipedia.org/wiki/Strategy_pattern) | [`Router`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/Router.java) ‚Äì –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –∑–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–∞–Ω–µ. |
|  | [**Command + Memento**](https://en.wikipedia.org/wiki/Command_pattern) | [`CommandStack`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/ui/commands/CommandStack.java) ‚Äì –æ—Å–∏–≥—É—Ä—è–≤–∞ undo/redo (–ø–ª–∞–Ω–∏—Ä–∞–Ω–æ –∑–∞ –±—ä–¥–µ—â–∏ –≤–µ—Ä—Å–∏–∏). |
|  | [**Mediator**](https://en.wikipedia.org/wiki/Mediator_pattern) | [`MainWindowMediator`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/ui/MainWindowMediator.java) ‚Äì –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ—Ç–æ –º–µ–∂–¥—É –±—É—Ç–æ–Ω–∏—Ç–µ –∏ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞. |

---

## üßµ –ú–æ–¥–µ–ª –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç

| –ù–∏—à–∫–∞ | –û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç |
|--------|--------------|
| **EDT (Swing)** | –ì—Ä–∞—Ñ–∏–∫–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è. |
| **–°–∏–º—É–ª–∞—Ü–∏–æ–Ω–µ–Ω –ø–ª–∞–Ω–∏—Ä–æ–≤—á–∏–∫** | –ó–∞–¥–µ–π—Å—Ç–≤–∞ —Ü–∏–∫—ä–ª–∞ –Ω–∞ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞ –Ω–∞ –≤—Å–µ–∫–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª. |
| **–†–∞–±–æ—Ç–µ–Ω –ø—É–ª** | –ò–∑–ø—ä–ª–Ω—è–≤–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ç–∞ –Ω–∞ –ø—Ä–µ–≤–æ–∑–Ω–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø–∞—Ä–∞–ª–µ–ª–Ω–æ. |

[`SimulationEngine`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationEngine.java)  
[`SimulationFacade`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationFacade.java)

---

## üßÆ –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ø–ª—ä–≥–∏–Ω–∏

- [`SimpleMetricsRegistry`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/metrics/SimpleMetricsRegistry.java) ‚Äì —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞ –±—Ä–æ—è—á–∏ –∏ –≤—Ä–µ–º–µ–Ω–∞.  
- –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø–ª—ä–≥–∏–Ω–∏ —á—Ä–µ–∑ [`META-INF/services/metrosim.themes.CityPackFactory`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/resources/META-INF/services/metrosim.themes.CityPackFactory).  
- –ü—Ä–∏–º–µ—Ä–µ–Ω –ø–ª—ä–≥–∏–Ω: [`SofiaPackFactory`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/themes/SofiaPackFactory.java).

---

## üîÑ –ü–æ—Ç–æ–∫ –Ω–∞ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞

1. **Start** ‚Üí –∏–∑–≤–∏–∫–≤–∞ `SimulationFacade.start()` –∏ —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—á–∏–∫–∞.  
2. **Engine tick** ‚Üí `SimulationEngine.step()` –æ–±–Ω–æ–≤—è–≤–∞ –≤—Å–∏—á–∫–∏ –ø—Ä–µ–≤–æ–∑–Ω–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞.  
3. **Snapshot publish** ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä–∞ —Å–µ –Ω–æ–≤ `WorldSnapshot`, –∫–æ–π—Ç–æ —Å–µ –ø—É–±–ª–∏–∫—É–≤–∞ –∫—ä–º UI.  
4. **UI repaint** ‚Üí –ø–∞–Ω–µ–ª–∏—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–∞—Ç —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –Ω–∞ EDT.  
5. **Pause** ‚Üí `CancellationToken` –ø—Ä–µ–∫—ä—Å–≤–∞ —Å–∏–º—É–ª–∞—Ü–∏—è—Ç–∞.  
6. **Restart** ‚Üí —Ç–æ–∫–µ–Ω—ä—Ç —Å–µ —Ä–µ—Å–µ—Ç–∏—Ä–∞ –∏ —Ü–∏–∫—ä–ª—ä—Ç –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞.

---

## üß™ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞ –æ—Ü–µ–Ω—è–≤–∞–Ω–µ

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –¢–µ–∂–µ—Å—Ç |
|-----------|--------|
| –ö–æ—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–ª–∞–≥–∞–Ω–µ –Ω–∞ ‚â•6 GoF —à–∞–±–ª–æ–Ω–∞ | 30% |
| –ö–æ—Ä–µ–∫—Ç–Ω–æ—Å—Ç –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—Ç–∞ –∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞ | 25% |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —á–µ—Ç–∏–º–æ—Å—Ç –Ω–∞ –∫–æ–¥–∞ | 20% |
| –†–∞–∑—à–∏—Ä—è–µ–º–æ—Å—Ç (–ø–ª—ä–≥–∏–Ω–∏, —Ç–µ–º–∏, –º–∞—Ä—à—Ä—É—Ç–∏) | 15% |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–±—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ —à–∞–±–ª–æ–Ω–∏—Ç–µ | 10% |

---

## üß± –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ

```bash
# –ö–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ –∏ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ (–∏–∑–∏—Å–∫–≤–∞ JDK 17)
./gradlew run

# –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ —Å –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –≥—Ä–∞–¥—Å–∫–∞ —Ç–µ–º–∞
./gradlew run -Dmetrosim.cityPack=sofia
```

# üß≠ Project Task Description  
### MetroSim: Concurrent Transit Network Simulator (Swing, Java 17)

---

## üéØ Overview

**MetroSim** is a desktop **transit network simulator** that visualizes vehicles moving through a simplified metro or bus system.  
It demonstrates how **multiple GoF design patterns** can be combined in a **parallel, event-driven Swing application** to achieve scalability, modularity, and maintainability.

The project serves as a **reference implementation** for university courses in:

- **Design Patterns** ‚Äì showing how patterns interact in a cohesive architecture.  
- **Parallel Programming** ‚Äì demonstrating safe concurrency in GUI applications.  

> üß© The application uses **Java Swing** for the UI and **Executor-based concurrency** for the simulation core.

---

## üß† Problem Statement

Implement a simulator for a metro network where multiple vehicles move along virtual routes.  
Each vehicle:
- Starts at a specified node.
- Moves step-by-step toward its destination.
- Waits (‚Äúdwells‚Äù) briefly upon arrival, then reverses direction.
- Operates concurrently with all other vehicles.

The system must:
- Continuously advance a **simulation clock**.
- Allow **Start** / **Pause** control of the simulation.
- Update the Swing UI in real time without blocking the Event Dispatch Thread.
- Maintain high extensibility for future features such as new cities, routers, or event visualizations.

---

## üß© Architecture Overview

| Layer | Description |
|-------|--------------|
| [**app/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/app) | Entry point and dependency composition ([`Bootstrap.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/app/Bootstrap.java), [`MetroSimApp.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/app/MetroSimApp.java)). |
| [**ui/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/ui) | Swing GUI components ([`MainWindow.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/ui/MainWindow.java)), panels, and mediator. |
| [**domain/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/domain) | Core simulation model (world, vehicles, states, snapshots). |
| [**infrastructure/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/infrastructure) | Concurrent engine ([`SimulationEngine.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationEngine.java)) and facade ([`SimulationFacade.java`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationFacade.java)). |
| [**services/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/services) | Routing, scenario loading, and plugins. |
| [**metrics/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/metrics) | Lightweight performance counters (Decorator target). |
| [**themes/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/themes) | Theme factories and plugin examples (Default, Sofia). |
| [**events/**](https://github.com/Alex-Tsvetanov/MetroSim/tree/main/src/main/java/metrosim/events) | Observer/event system for decoupled updates. |

---

## üß© Key Features

- **Real-time simulation** of vehicles and world clock.
- **Responsive Swing UI** ‚Äî updates through immutable `WorldSnapshot`s.
- **Thread-safe parallelism** using `ForkJoinPool` and `ScheduledExecutorService`.
- **Extensible design** ‚Äî new routers, cities, or metrics via plugins.
- **Command pattern scaffold** for future editing / undo-redo operations.

---

## ‚öôÔ∏è Functional Requirements

| Category | Description |
|-----------|--------------|
| **User Interface** | Swing main window with Start / Pause controls, map, timeline, and inspector panels. |
| **Simulation Core** | Background engine advancing ticks and publishing [`WorldSnapshot`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/domain/WorldSnapshot.java). |
| **Concurrency** | Parallel vehicle updates using a work-stealing thread pool; cancellable execution tokens. |
| **Extensibility** | City themes discovered via [Java ServiceLoader](https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html). |
| **Metrics** | Performance counters via [`SimpleMetricsRegistry`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/metrics/SimpleMetricsRegistry.java). |

---

## üß© Design Patterns Used

| Category | Pattern | Implementation |
|-----------|----------|----------------|
| **Creational** | [**Abstract Factory**](https://en.wikipedia.org/wiki/Abstract_factory_pattern) | [`CityPackFactory`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/themes/CityPackFactory.java) for visual themes (Default, Sofia). |
|  | [**Builder**](https://en.wikipedia.org/wiki/Builder_pattern) | [`ScenarioBuilder`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/scenario/ScenarioBuilder.java) constructs world configurations. |
| **Structural** | [**Facade**](https://en.wikipedia.org/wiki/Facade_pattern) | [`SimulationFacade`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationFacade.java) hides concurrency and scheduling logic. |
|  | [**Decorator**](https://en.wikipedia.org/wiki/Decorator_pattern) | [`MeteredRouter`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/MeteredRouter.java), [`LoggingRouter`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/LoggingRouter.java). |
|  | [**Adapter**](https://en.wikipedia.org/wiki/Adapter_pattern) | [`ThirdPartyRouterAdapter`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/ThirdPartyRouterAdapter.java) wraps an incompatible pathfinding API. |
| **Behavioral** | [**Observer**](https://en.wikipedia.org/wiki/Observer_pattern) | [`Subject`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/events/Subject.java) publishes snapshots to UI observers. |
|  | [**State**](https://en.wikipedia.org/wiki/State_pattern) | [`Vehicle`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/domain/Vehicle.java) transitions between Idle ‚Üí EnRoute ‚Üí Dwell. |
|  | [**Strategy**](https://en.wikipedia.org/wiki/Strategy_pattern) | [`Router`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/services/routing/Router.java) defines pluggable routing strategies. |
|  | [**Command + Memento**](https://en.wikipedia.org/wiki/Command_pattern) | [`CommandStack`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/ui/commands/CommandStack.java) enables undo/redo (future editor). |
|  | [**Mediator**](https://en.wikipedia.org/wiki/Mediator_pattern) | [`MainWindowMediator`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/ui/MainWindowMediator.java) coordinates button actions. |

---

## üßµ Concurrency Model

| Thread | Responsibility |
|--------|----------------|
| **EDT (Swing)** | Handles rendering and user interaction. |
| **Simulation Scheduler** | Periodically triggers simulation ticks. |
| **Worker Pool** | Executes per-vehicle updates and routing in parallel. |

> Snapshots are immutable, ensuring **no data races** between simulation threads and the Swing Event Dispatch Thread.

[`SimulationEngine`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationEngine.java)  
[`SimulationFacade`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/infrastructure/SimulationFacade.java)

---

## üßÆ Metrics and Plugins

- [`SimpleMetricsRegistry`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/metrics/SimpleMetricsRegistry.java) tracks counters and durations.  
- Plugins discovered via [`META-INF/services/metrosim.themes.CityPackFactory`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/resources/META-INF/services/metrosim.themes.CityPackFactory).  
- Example plugin: [`SofiaPackFactory`](https://github.com/Alex-Tsvetanov/MetroSim/blob/main/src/main/java/metrosim/themes/SofiaPackFactory.java).

---

## üß© Simulation Flow

1. **Start** ‚Üí `SimulationFacade.start()` schedules periodic ticks.  
2. **Engine tick** ‚Üí `SimulationEngine.step()` updates each `Vehicle` concurrently.  
3. **Snapshot publish** ‚Üí New `WorldSnapshot` broadcast via `Subject`.  
4. **UI repaint** ‚Üí Panels render snapshot asynchronously on EDT.  
5. **Pause** ‚Üí `CancellationToken` cooperatively stops tasks.  
6. **Restart** ‚Üí Token resets; scheduler resumes (safe resume after pause).

---

## üß™ Evaluation Criteria

| Aspect | Weight |
|--------|--------|
| Correct application of ‚â•6 GoF patterns | 30% |
| Concurrency correctness & responsiveness | 25% |
| Clean architecture & code organization | 20% |
| Extensibility (plugins, routers, cities) | 15% |
| Documentation and clarity | 10% |

---

## üß± Run Instructions

```bash
# Build and run (requires JDK 17)
./gradlew run

# Run with alternative city pack
./gradlew run -Dmetrosim.cityPack=sofia
```